% （１）DDFとは何か？
% （２）DDFを実現する上で難しいこと。
% （３）２を解決するための方法（ネットワークアーキテクチャ）。
% （４）２を解決するための方法（訓練データの制約とそれに伴う推論時の工夫）。
% （５）訓練の詳細（と法線マップのレンダリング）。
% 我々はDirectional Distance Function（DDF）をマルチインスタンス表現できるよう事前訓練し、その潜在空間の最適化を介して形状推定を行う（Fig.2）。
% DDFはimplicit function-base shape representationの１つであり，視点位置と視線方向、潜在コードを入力として物体正面までの距離を出力する。
% Occupancy NetworksやDeepSDFといった既存の陰関数表現と比べ、DDFは1ピクセルあたり1度のForward演算で物体正面までの距離を評価できるため、レンダリングの際のComputational Costが低い。
% しかし、DDFの訓練は次の２点の理由からchallengingである。
% 第一に、DDFは形状を空間の三次元位置ではなく、視点位置と視線方向から形状を出力するため、しばしばビューの変化につられて意図しない形状の歪みが生じてしまう。
% 第二に、入力次元が高いため、単純な方法で訓練を行うと膨大な量のデータが必要になる。
% そこで我々はビューが変化しても一貫性ある形状を出力するために、Latent Voxelと呼ぶ、低解像な三次元特徴量をネットワーク上流に導入する。
% また訓練は物体中心から一定距離離れた、１つの基準球面上のみの視点で行う。

視点につられた意図しない形状の歪みを防ぐため、潜在コードを一度低解像な三次元特徴量Latent Voxelに変換するネットワークを構成する。
入力されたLatent Code zはまず、Latent Decoderを介して低解像な三次元特徴量であるLatent Voxelに変換される。
一度特徴量を明示的に三次元へリフトアップすることで、椅子の背もたれなどといったディティール部分の一貫性が向上する（Fig.4）。
MLPは、得られた低解像な三次元特徴量を足掛かりに、物体表面までの位置を出力する。
そのために我々はまず、Latent Voxel内部をRayに沿ってサンプリングする。
そして、サンプリングで得られた特徴量を連結し、MLP f_mlpに入力する。
物体表面にRayがヒットしなかった際、無限大（無限遠）に回帰しなければならないことを防ぐため、MLP f_mlpは距離の逆数を出力する。

また冗長なデータを減らすため、基準球面上の視点だけから距離を推定できるよう、制限してDDFの訓練は行う。
この制約により、視点が球面上のみに制限され，入力の自由度を５次元から４次元へ削減することができる。
During inference、我々は基準球面とRayの交点をＤＤＦに入力することで、物体のBbox外部の全ての視点から距離を推論できる。
推論したい視点が基準球面状にないとき、我々はまずその視点に最も近い球面状との交点を求める。
すると物体表面までの距離は、視点から交点までの距離と、交点から物体表面までの距離の和で表される。
訓練中はauto-decoder formulationに従い、損失関数が最小化するようにネットワークパラメータと潜在コードを更新する。
損失関数は、物体表面までの距離の推定誤差とsurface normalの推定誤差、潜在空間に対する正則化項の和である。
surface normalは、推論しているRayがヒットしたsurface positionと、視線方向を微小値摂動させることで得た2つのsurface positionを結ぶ2つベクトルの外積で得られる。

- 我々は深層指向性距離場関数（DeepDDF）を同じカテゴリーに属する複数の物体を表現できるよう事前訓練し、その潜在空間の最適化を介して形状推定を行う。
- DeepDDF表現を学習することは、既存の陰関数に基づいた手法に比べ以下の２点が困難である。
- 我々のネットワークはMLPと、視点による形状の歪みを防ぐため導入した Latent Decoder で構成されている。
- 冗長なデータを減らすため、基準球面上の視点だけから距離を推定できるよう、制限してDDFの訓練を行う。

- 我々の目標はカメラポーズとインスタンスセグメンテーション、物体追跡が既知のRGB-D画像から、物体の7-DoFポーズと形状を推定することである。
- 我々の手法は形状表現を担う深層指向性距離場関数（DeepDDF）と、観測とDeepDDFから得た予測の誤差から更新値を出力するTransformerに基づいて定式化された深層最適化モデル（Poser）から構成されている。